<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Bus Route</title>
    <meta name="viewport" content="initial-scale=1,maximum-scale=1,user-scalable=no">
    <link href="https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.css" rel="stylesheet">
    <script src="https://api.mapbox.com/mapbox-gl-js/v2.13.0/mapbox-gl.js"></script>
    <style>
        body { margin: 0; padding: 0; }
        #map { position: absolute; top: 0; bottom: 0; width: 100%; }
    </style>
  </head>
<body>
    <style>
      #menu {
          position: absolute;
          margin: 0 auto;
          background: #fb5b3f;
          color: #fff;
          font-weight: bold;
          padding: 10px;
          border: 2px solid #fff;
          border-radius: 0.5em;
          left: 101.5em;
          top: 0.5em;
          box-shadow: 0px 0px 5px rgba(0,0,0,0.2);
          font-family: 'Open Sans', sans-serif;
        }
    </style>
      <div id="map"></div>
 
      <div id="menu">
        <input id="clezsexel000m01rn08x0a6un" type="radio" name="rtoggle" value="streets" checked="checked">
        <label for="clezsexel000m01rn08x0a6un">streets</label>
        <input id="clf0crl57000201p9755fitgu" type="radio" name="rtoggle" value="satellite">
        <label for="clf0crl57000201p9755fitgu">satellite</label>
      </div>
    <script>
	    mapboxgl.accessToken = 'pk.eyJ1IjoiY3VzdG9tZXJpbnNpZ2h0cyIsImEiOiJjbDlvMXAwdzAwNTl0M3VsYjJ2amVkMmgyIn0.bcZJMNFbrqBWswyKnj5xKQ';
      const map = new mapboxgl.Map({
      container: 'map', // container ID
      // Choose from Mapbox's core styles, or make your own style with Mapbox Studio
      style: 'mapbox://styles/customerinsights/clezsexel000m01rn08x0a6un', // style URL
      center: [151.694458, -32.965705], // starting position [lng, lat]
      zoom: 12, // starting zoom
      projection: 'mercator'
      });
      
      // Add GeoJSON source and layer
      function addAdditionalSourceAndLayer() {
        map.addSource('places', {
                              type: 'geojson',
                              data: {
                              type: 'FeatureCollection',
                              features: [
                                  {
                                  type: 'Feature',
                                  properties: {
                                      description:
                                          '<h3>Frederick St</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">104.1m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.694458, -32.965705]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Kahibah Rd</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">108.9m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.702403, -32.965125]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Glebe St</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">101.3m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.712195, -32.962025]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                          description:
                                              '<h3>Pacific Hwy</h3>' +
                                              '<table style="width: 100%;">' +
                                              '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                              '<td style="text-align: left;">sealed road</td></tr>' +
                                              '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                              '<td style="text-align: left;">101.2m</td></tr>' +
                                              '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.71188, -32.952733]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Sunhill Dr</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">100.9m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.728753, -32.948169]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Morgan St</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">35.0m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.737763, -32.94421]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Llewellyn St</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">16.8m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.749747, -32.939388]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Stewart Ave</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">8.0m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.75289, -32.931942]
                                      }
                                  },
                                  {
                                      type: 'Feature',
                                      properties: {
                                      description:
                                          '<h3>Newcastle Interchange</h3>' +
                                          '<table style="width: 100%;">' +
                                          '<tr><td style="width: 100px; text-align: left;">road surface:</td>' +
                                          '<td style="text-align: left;">sealed road</td></tr>' +
                                          '<tr><td style="width: 100px; text-align: left;">elevation:</td>' +
                                          '<td style="text-align: left;">10.4m</td></tr>' +
                                          '</table>'
                                      },
                                      'geometry': {
                                          'type': 'Point',
                                          'coordinates': [151.758471, -32.924056]
                                      }
                                  }
                              ]
                          }
                      });

                      map.addLayer({
                          'id': 'places',
                          'type': 'circle',
                          'source': 'places',
                          'paint': {
                              'circle-color': '#0099FF',
                              'circle-radius': 7,
                              'circle-stroke-width': 2,
                              'circle-stroke-color': '#ffffff'
                          }
                      });
                    }
      
      // Add source and layer whenever base style is loaded
        map.on('style.load', () => {
          addAdditionalSourceAndLayer();
          });
            
        const layerList = document.getElementById('menu');
        const inputs = layerList.getElementsByTagName('input');
            
        for (const input of inputs) {
            input.onclick = (layer) => {
            const layerId = layer.target.id;
            map.setStyle('mapbox://styles/customerinsights/' + layerId);
          };
        }
        // Create a popup, but don't add it to the map yet.
            const popup = new mapboxgl.Popup({
                  closeButton: false,
                  closeOnClick: false
                });

                map.on('mouseenter', 'places', (e) => {
                    // Change the cursor style as a UI indicator.
                    map.getCanvas().style.cursor = 'pointer';

                    // Copy coordinates array.
                    const coordinates = e.features[0].geometry.coordinates.slice();
                    const description = e.features[0].properties.description;

                    // Ensure that if the map is zoomed out such that multiple
                    // copies of the feature are visible, the popup appears
                    // over the copy being pointed to.
                    while (Math.abs(e.lngLat.lng - coordinates[0]) > 180) {
                        coordinates[0] += e.lngLat.lng > coordinates[0] ? 360 : -360;
                    }

                    // Populate the popup and set its coordinates
                    // based on the feature found.
                    popup.setLngLat(coordinates).setHTML(description).addTo(map);
                });

                map.on('mouseleave', 'places', () => {
                    map.getCanvas().style.cursor = '';
                    popup.remove();
                });

        map.addControl(new mapboxgl.FullscreenControl(), 'top-right');
        map.addControl(new mapboxgl.NavigationControl(), 'top-right');

    </script> 
  </body>
</html>
